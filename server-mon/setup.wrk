{"data":[{"id":"1713488776486953","contents":"# Schema Setup\n- Create monitoring Tag Table with rollup table for fast data navigation","height":68,"lineHeight":19,"minimal":true,"type":"mrk","tqlType":null,"lang":[["markdown","Markdown"],["SQL","SQL"],["go","TQL"]],"result":"","status":true},{"id":"1713503528102258","contents":"-- drop table home cascade;\ncreate tag table if not exists monitoring (\n    name varchar(32) primary key,\n    time datetime basetime,\n    value double summarized\n) with rollup;\n\n\n-- alarm history log table\ncreate table alarm_history (name varchar(128), time datetime, value double, desc varchar(1024));","height":208,"lineHeight":19,"minimal":false,"type":"sql","tqlType":null,"lang":[["markdown","Markdown"],["SQL","SQL"],["go","TQL"]],"result":"","status":true,"brief":false},{"id":"17135093253871","contents":"# About agent\n## JSON agent \n- This collects all system information CPU Usage, Total Disk Size, Used Disk Size, Remaining Disk Size, Network Bandwidth In/OUT respectively CPU, DT, DU, DR, NI, NO.\n- After collecting all information, this append all data into NEO DBMS directly without any pre-processing.\n- Usage\n```\n$ python3 run-agent-json.py -h\nusage: run-agent-json.py [-h] [--ip_address IP_ADDRESS] [--interval INTERVAL] [--servername SERVERNAME]\n                         [--debug DEBUG]\n                         url tablename\nSystem Statistics Collector\npositional arguments:\n  url                   NEO-URL (e.g., http://host:port)\n  tablename             Table name for data storage\noptions:\n  -h, --help            show this help message and exit\n  --ip_address IP_ADDRESS\n                        IP Address prefix to filter (default: \"\")\n  --interval INTERVAL   Interval between posts in seconds (default: 3)\n  --servername SERVERNAME\n                        servername\n  --debug DEBUG         debugging\n \nex) python3 run-agent-json.py http://192.168.0.33:5654 monitoring --interval 1\n```","height":504,"lineHeight":19,"minimal":true,"type":"mrk","tqlType":null,"lang":[["markdown","Markdown"],["SQL","SQL"],["go","TQL"]],"result":"","status":true},{"id":"1713509265664393","contents":"## TQL agent \n- This collects is all the same information such as JSON agent except using TQL.\n- This sample tql file, append.tql check the CPU outlier Usage and insert it into alarm_history log table.\n- Users can extend this sample tql as much as needed.\n- Usage\n```\n$ python3 run-agent-tql.py -h\nusage: run-agent-tql.py [-h] [--ip_address IP_ADDRESS] [--interval INTERVAL] [--servername SERVERNAME]\n                        [--debug DEBUG]\n                        url tablename\n\nSystem Statistics Collector\n\npositional arguments:\n  url                   NEO-URL (e.g., http://host:port/db/tql/neo-apps/server-mon/append.tql)\n  tablename             Table name for data storage\n\noptions:\n  -h, --help            show this help message and exit\n  --ip_address IP_ADDRESS\n                        IP Address prefix to filter (default: \"\")\n  --interval INTERVAL   Interval between posts in seconds (default: 3)\n  --servername SERVERNAME\n                        servername\n  --debug DEBUG         debugging\n \nex) python3 run-agent-tql.py http://127.0.0.1:5654/db/tql/neo-apps/server-mon/append.tql monitoring --interval 3\n```","height":435,"lineHeight":19,"minimal":true,"type":"mrk","tqlType":null,"lang":[["markdown","Markdown"],["SQL","SQL"],["go","TQL"]],"result":"","status":true},{"id":"1713588761976261","contents":"# How to run JSON agent\r\n## Before run agent\r\n- check whether machbase-neo is running (ex: 127.0.0.1:5654)\r\n- check whether the tables has created (ex : monitoring & alarm_history)\r\n## On linux\r\njust invoke the script as belows\r\n```\r\n:~/neo-apps/server-mon$ python3 run-agent-json.py http://127.0.0.1:5654 monitoring --servername linux\r\n{'data': {'columns': ['name', 'time', 'value'], 'rows': [['CPU-linux', 1713589096, 0.2], ['DU-linux', 1713589096, 153642360832], ['DT-linux', 1713589096, 538854957056], ['DR-linux', 1713589096, 385212596224], ['NI-linux', 1713589096, 0], ['NO-linux', 1713589096, 0]]}}\r\n{'success': True, 'reason': 'success, 6 record(s) appended', 'elapse': '3.335237ms'}\r\n{'data': {'columns': ['name', 'time', 'value'], 'rows': [['CPU-linux', 1713589100, 0.0], ['DU-linux', 1713589100, 153642360832], ['DT-linux', 1713589100, 538854957056], ['DR-linux', 1713589100, 385212596224], ['NI-linux', 1713589100, 246863], ['NO-linux', 1713589100, 246863]]}}\r\n{'success': True, 'reason': 'success, 6 record(s) appended', 'elapse': '781.145µs'}\r\n{'data': {'columns': ['name', 'time', 'value'], 'rows': [['CPU-linux', 1713589104, 0.0], ['DU-linux', 1713589104, 153642360832], ['DT-linux', 1713589104, 538854957056], ['DR-linux', 1713589104, 385212596224], ['NI-linux', 1713589104, 124171], ['NO-linux', 1713589104, 124171]]}}\r\n{'success': True, 'reason': 'success, 6 record(s) appended', 'elapse': '781.437µs'}\r\n... appending....\r\n```\r\n## On Windows\r\n```\r\nC:\\Users\\ratse\\work\\neo-apps\\server-mon>python3 run-agent-json.py http://127.0.0.1:5654 monitoring --servername windows\r\n{'data': {'columns': ['name', 'time', 'value'], 'rows': [['CPU-windows', 1713589213, 3.8], ['DU-windows', 1713589213, 1814348320768], ['DT-windows', 1713589213, 1922094321664], ['DR-windows', 1713589213, 107746000896], ['NI-windows', 1713589213, 0], ['NO-windows', 1713589213, 0]]}}\r\n{'success': True, 'reason': 'success, 6 record(s) appended', 'elapse': '3.985848ms'}\r\n{'data': {'columns': ['name', 'time', 'value'], 'rows': [['CPU-windows', 1713589217, 4.3], ['DU-windows', 1713589217, 1814348320768], ['DT-windows', 1713589217, 1922094321664], ['DR-windows', 1713589217, 107746000896], ['NI-windows', 1713589217, 4172], ['NO-windows', 1713589217, 2342]]}}\r\n{'success': True, 'reason': 'success, 6 record(s) appended', 'elapse': '952.769µs'}\r\n{'data': {'columns': ['name', 'time', 'value'], 'rows': [['CPU-windows', 1713589221, 6.2], ['DU-windows', 1713589221, 1814348455936], ['DT-windows', 1713589221, 1922094321664], ['DR-windows', 1713589221, 107745865728], ['NI-windows', 1713589221, 1867], ['NO-windows', 1713589221, 708]]}}\r\n{'success': True, 'reason': 'success, 6 record(s) appended', 'elapse': '4.104859ms'}\r\n... appending ...\r\n```","height":553,"lineHeight":19,"minimal":true,"type":"mrk","tqlType":null,"lang":[["markdown","Markdown"],["SQL","SQL"],["go","TQL"]],"result":"","status":true},{"id":"1713589362468838","contents":"# How to run TQL agent\r\n## Before run agent\r\n- check whether machbase-neo is running (ex: 127.0.0.1:5654)\r\n- check whether the tables has created (ex : monitoring & alarm_history)\r\n","height":242,"lineHeight":19,"minimal":true,"type":"mrk","tqlType":null,"lang":[["markdown","Markdown"],["SQL","SQL"],["go","TQL"]],"result":"","status":true},{"id":"1713589419304642","contents":"## append.tql\r\nif the CPU usage is over 60, insert the alarm logs into 'alarm-history' table. \r\n```python\r\nCSV(payload())\r\n\r\nMAPVALUE(1, parseFloat(value(1)) * 1000000000)\r\nMAPVALUE(2, parseFloat(value(2)))\r\n\r\nWHEN(glob(\"CPU-*\", value(0)) && value(2) > 60,\r\n      do( value(0), value(1), value(2), {\r\n        ARGS()\r\n        MAPVALUE(3, strSprintf(\"CPU overheating..: more than %f\", 60))\r\n        INSERT(\"name\", \"time\", \"value\", \"desc\", table(\"alarm_history\"))    \r\n        }\r\n      )\r\n    )\r\nAPPEND(table(param('table') ?? 'monitoring'))\r\n```","height":289,"lineHeight":19,"minimal":false,"type":"mrk","tqlType":null,"lang":[["markdown","Markdown"],["SQL","SQL"],["go","TQL"]],"result":"","status":true},{"id":"1713589417386730","contents":"## On linux\r\nrun below command\r\n```bash\r\npython3 run-agent-tql.py http://127.0.0.1:5654/db/tql/neo-apps/server-mon/append.tql monitoring --servername linux\r\n```\r\nresult\r\n```shell\r\nsjkim@gamestar:~/neo/current/neo-apps/server-mon$ python3 run-agent-tql.py http://127.0.0.1:5654/db/tql/neo-apps/server-mon/append.tql monitoring --servername linux\r\nhttp://127.0.0.1:5654/db/tql/neo-apps/server-mon/append.tql?table=monitoring\r\n{'data': {'columns': ['name', 'time', 'value'], 'rows': [['CPU-linux', 1713589692, 0.1], ['DU-linux', 1713589692, 153642491904], ['DT-linux', 1713589692, 538854957056], ['DR-linux', 1713589692, 385212465152], ['NI-linux', 1713589692, 0], ['NO-linux', 1713589692, 0]]}}\r\n###\r\nCPU-linux,1713589692,0.1\r\nDU-linux,1713589692,153642491904\r\nDT-linux,1713589692,538854957056\r\nDR-linux,1713589692,385212465152\r\nNI-linux,1713589692,0\r\nNO-linux,1713589692,0\r\n\r\n{'success': True, 'reason': 'success', 'elapse': '2.013497ms', 'data': {'message': 'append 6 rows (success 6, fail 0)'}}\r\n{'data': {'columns': ['name', 'time', 'value'], 'rows': [['CPU-linux', 1713589696, 0.5], ['DU-linux', 1713589696, 153642491904], ['DT-linux', 1713589696, 538854957056], ['DR-linux', 1713589696, 385212465152], ['NI-linux', 1713589696, 125055], ['NO-linux', 1713589696, 125055]]}}\r\n###\r\nCPU-linux,1713589696,0.5\r\nDU-linux,1713589696,153642491904\r\nDT-linux,1713589696,538854957056\r\nDR-linux,1713589696,385212465152\r\nNI-linux,1713589696,125055\r\nNO-linux,1713589696,125055\r\n\r\n{'success': True, 'reason': 'success', 'elapse': '971.917µs', 'data': {'message': 'append 6 rows (success 6, fail 0)'}}\r\n```\r\n## On Windows\r\n```cmd\r\npython3 run-agent-tql.py http://127.0.0.1:5654/db/tql/neo-apps/server-mon/append.tql monitoring --servername windows\r\n```\r\nresult\r\n```shell\r\nC:\\Users\\ratse\\work\\neo-apps\\server-mon>python3 run-agent-tql.py http://127.0.0.1:5654/db/tql/neo-apps/server-mon/append.tql monitoring --servername windows\r\nhttp://127.0.0.1:5654/db/tql/neo-apps/server-mon/append.tql?table=monitoring\r\n{'data': {'columns': ['name', 'time', 'value'], 'rows': [['CPU-windows', 1713589780, 6.3], ['DU-windows', 1713589780, 1814361403392], ['DT-windows', 1713589780, 1922094321664], ['DR-windows', 1713589780, 107732918272], ['NI-windows', 1713589780, 0], ['NO-windows', 1713589780, 0]]}}\r\n###\r\nCPU-windows,1713589780,6.3\r\nDU-windows,1713589780,1814361403392\r\nDT-windows,1713589780,1922094321664\r\nDR-windows,1713589780,107732918272\r\nNI-windows,1713589780,0\r\nNO-windows,1713589780,0\r\n\r\n{'success': True, 'reason': 'success', 'elapse': '1.157682ms', 'data': {'message': 'append 6 rows (success 6, fail 0)'}}\r\n{'data': {'columns': ['name', 'time', 'value'], 'rows': [['CPU-windows', 1713589784, 3.6], ['DU-windows', 1713589784, 1814361411584], ['DT-windows', 1713589784, 1922094321664], ['DR-windows', 1713589784, 107732910080], ['NI-windows', 1713589784, 706], ['NO-windows', 1713589784, 654]]}}\r\n###\r\nCPU-windows,1713589784,3.6\r\nDU-windows,1713589784,1814361411584\r\nDT-windows,1713589784,1922094321664\r\nDR-windows,1713589784,107732910080\r\nNI-windows,1713589784,706\r\nNO-windows,1713589784,654\r\n\r\n{'success': True, 'reason': 'success', 'elapse': '788.265µs', 'data': {'message': 'append 6 rows (success 6, fail 0)'}}\r\n{'data': {'columns': ['name', 'time', 'value'], 'rows': [['CPU-windows', 1713589788, 3.7], ['DU-windows', 1713589788, 1814361411584], ['DT-windows', 1713589788, 1922094321664], ['DR-windows', 1713589788, 107732910080], ['NI-windows', 1713589788, 10297], ['NO-windows', 1713589788, 8225]]}}\r\n###\r\nCPU-windows,1713589788,3.7\r\nDU-windows,1713589788,1814361411584\r\nDT-windows,1713589788,1922094321664\r\nDR-windows,1713589788,107732910080\r\nNI-windows,1713589788,10297\r\nNO-windows,1713589788,8225\r\n\r\n{'success': True, 'reason': 'success', 'elapse': '900.888µs', 'data': {'message': 'append 6 rows (success 6, fail 0)'}}\r\n```","height":694,"lineHeight":19,"minimal":true,"type":"mrk","tqlType":null,"lang":[["markdown","Markdown"],["SQL","SQL"],["go","TQL"]],"result":"","status":true},{"id":"1713587394828427","contents":"# Dashboard screen\r\n![alt text](https://raw.githubusercontent.com/machbase/neo-apps/main/img/server_mon.png \"Logo Title Text 1\")","height":200,"lineHeight":19,"minimal":false,"type":"mrk","tqlType":null,"lang":[["markdown","Markdown"],["SQL","SQL"],["go","TQL"]],"result":"","status":true},{"id":"1713590756621536","contents":"# Alarm history\r\n![alt text](https://raw.githubusercontent.com/machbase/neo-apps/main/img/alarm-history.png \"Logo Title Text 1\")","height":200,"lineHeight":19,"minimal":false,"type":"mrk","tqlType":null,"lang":[["markdown","Markdown"],["SQL","SQL"],["go","TQL"]],"result":"","status":true}]}